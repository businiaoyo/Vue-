{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observe{\r\n    constructor(data){\r\n        this.walk(data);\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>defineReactive(data, key, data[key]))\r\n    }\r\n}\r\nexport function defineReactive(target, key, value){\r\n    observe(value);\r\n    Object.defineProperty(target, key, {\r\n        get(){\r\n            console.log('get...');\r\n            return value;\r\n        },\r\n        set(newValue){\r\n            console.log('set...');\r\n            if(newValue === value) return;\r\n            value = newValue;\r\n        }\r\n    })\r\n}\r\nexport function observe(data){\r\n    if(typeof data !== 'object' || data == null){\r\n        return;\r\n    }\r\n    return new Observe(data);\r\n}","import { observe } from \"./observe/index\";\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function(options) {\r\n    // 原型中的this，指向都是实例\r\n    let vm = this;\r\n    vm.$options = options;\r\n\r\n    initState(vm);\r\n  };\r\n  Vue.prototype.xxx = function(){\r\n    \r\n  }\r\n\r\n}\r\nfunction initState(vm){\r\n    const opts = vm.$options;\r\n    if(opts.data){\r\n        initData(vm);\r\n    }\r\n}\r\nfunction proxy(vm, target, key){\r\n    Object.defineProperty(vm, key, {\r\n        get(){\r\n            // 更深度的对象，比如deepSchool，将其绑定到vm上之后，对deepSchool的深度访问其实就是对_data中的deepSchool的深度访问，不必再另行绑定\r\n            return vm[target][key] \r\n        },\r\n    })\r\n}\r\nfunction initData(vm){\r\n   let data = vm.$options.data;\r\n   // 函数 或者 对象\r\n   data = typeof data === 'function'? data.call(vm) : data\r\n   console.log(\"this\", data);\r\n   // options中只有下划线data, 需要将劫持后的data绑到_data上。 这里是浅拷贝（拷贝了引用），对data的操作相当于对_data的操作\r\n   vm._data = data;\r\n   // 劫持数据 defineProperty\r\n   observe(data);\r\n   // 将_data中的属性绑定到vm示例上\r\n   for(let key in data){\r\n      proxy(vm, '_data', key);\r\n   }\r\n   console.log(\"vm\", vm);\r\n}","import { initMixin } from \"./init\"\r\n\r\nfunction Vue(options){\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue) // 拓展了init方法 initMixin中在Vue的原型上添加了很多init函数\r\n\r\nexport default Vue"],"names":["Observe","data","walk","Object","keys","forEach","key","defineReactive","target","value","observe","defineProperty","get","console","log","set","newValue","initMixin","Vue","prototype","_init","options","vm","$options","initState","xxx","opts","initData","proxy","call","_data"],"mappings":"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"}